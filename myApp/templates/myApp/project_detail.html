{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div class="bg-white border-bottom sticky-top" style="z-index: 10;">
    <div class="container py-3 d-flex align-items-center justify-content-between">
        <a href="{% url 'home' %}" class="text-decoration-none text-muted fw-bold small hover-dark">
            <i class="fa-solid fa-arrow-left me-2"></i>Back to Projects
        </a>
    </div>
</div>

<div class="container py-5">
    <div class="row gx-lg-5">

        <div class="col-lg-8">

            <div class="mb-4">
                <h1 class="fw-bold h2 text-dark mb-2">{{ project.title }}</h1>
                <p class="text-secondary mb-0" style="font-size: 1.05rem;">{{ project.summary }}</p>
            </div>

            <div class="rounded-4 overflow-hidden border mb-5" style="background: #f8fafc; border: 1px solid #e2e8f0;">
                <div class="d-flex align-items-center justify-content-center p-4" style="min-height: 400px;">
                    {% if project.image %}
                        <img src="{{ project.image.url }}" class="img-fluid rounded shadow-sm" style="max-height: 500px; width: auto; object-fit: contain;" alt="{{ project.title }}">
                    {% else %}
                        <div class="text-center text-muted opacity-25">
                            <i class="fa-solid fa-image fa-4x mb-3"></i>
                            <p>No Preview Available</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="project-prose">
                <h3 class="fw-bold h4 text-dark mb-3 border-bottom pb-2">Technical Overview</h3>
                <div class="description-text fs-6 text-dark opacity-75" style="line-height: 1.8;">
                    {{ project.description|linebreaks }}
                </div>
            </div>
        </div>

        <div class="col-lg-4 mt-5 mt-lg-0">
            <div class="card border bg-white rounded-4 p-4 shadow-sm sticky-top" style="top: 5rem;">

                <h6 class="fw-bold text-uppercase text-muted small mb-3 tracking-wide">Deployment</h6>

                <div class="d-flex align-items-center justify-content-between mb-4 p-3 bg-light rounded-3 border">
                    <span class="small fw-semibold text-secondary">Status</span>
                    <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 px-3 py-2 rounded-pill">
                        <i class="fa-solid fa-circle fa-2xs me-2"></i>Production
                    </span>
                </div>

                <div class="d-grid gap-2 mb-4">
                    <a href="{{ project.address }}" target="_blank" class="btn btn-primary fw-bold py-2 shadow-sm">
                        <i class="fa-solid fa-rocket me-2"></i>View Live App
                    </a>
                    {% if project.github_link %}
                    <a href="{{ project.github_link }}" target="_blank" class="btn btn-white border fw-semibold py-2 hover-bg-light text-dark">
                        <i class="fa-brands fa-github me-2"></i>Source Code
                    </a>
                    {% endif %}
                </div>

                <hr class="border-light my-4">

                {% if project.tech_stack %}
                <div class="mb-3">
                    <h6 class="fw-bold text-uppercase text-muted small mb-3 tracking-wide">Technology Stack</h6>
                    <div class="d-flex flex-wrap gap-2">
                        {% for tech in project.tech_stack|split:"," %}
                          <span class="tech-badge">
                              {% with t=tech|lower %}
                                  {% if "python" in t %} <i class="fa-brands fa-python ti-python"></i>
                                  {% elif "django" in t and "rest" in t %} <i class="fa-solid fa-gear ti-drf"></i> {% elif "django" in t %} <i class="fa-solid fa-layer-group ti-django"></i>
                                  {% elif "docker" in t %} <i class="fa-brands fa-docker ti-docker"></i>
                                  {% elif "postgres" in t %} <i class="fa-solid fa-database ti-postgres"></i>
                                  {% elif "redis" in t %} <i class="fa-solid fa-server ti-redis"></i>
                                  {% elif "nginx" in t %} <i class="fa-solid fa-network-wired ti-nginx"></i>
                                  {% elif "celery" in t %} <i class="fa-solid fa-leaf ti-celery"></i>
                                  {% elif "aws" in t %} <i class="fa-brands fa-aws ti-aws"></i>
                                  {% elif "linux" in t %} <i class="fa-brands fa-linux ti-linux"></i>
                                  {% elif "git" in t %} <i class="fa-brands fa-git-alt ti-git"></i>

                                  {% elif "react" in t %} <i class="fa-brands fa-react ti-react"></i>
                                  {% elif "js" in t or "javascript" in t %} <i class="fa-brands fa-js ti-js"></i>
                                  {% elif "html" in t %} <i class="fa-brands fa-html5 ti-html"></i>
                                  {% elif "css" in t %} <i class="fa-brands fa-css3-alt ti-css"></i>
                                  {% elif "bootstrap" in t %} <i class="fa-brands fa-bootstrap ti-bootstrap"></i>
                                  {% elif "tailwind" in t %} <i class="fa-solid fa-wind ti-tailwind"></i>

                                  {% else %} <i class="fa-solid fa-code text-secondary"></i>
                                  {% endif %}
                              {% endwith %}
                              {{ tech|strip }}
                          </span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if user.is_authenticated %}
                <div class="mt-4 pt-3 border-top">
                    <a href="{% url 'edit_project' project.id %}" class="btn btn-sm btn-outline-secondary w-100">
                        <i class="fa-solid fa-pen me-1"></i> Edit Project
                    </a>
                </div>
                {% endif %}

            </div>
        </div>

    </div>
</div>
{% endblock content %}